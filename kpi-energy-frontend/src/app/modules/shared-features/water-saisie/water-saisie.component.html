<div class="container">
  <!-- En-tÃªte principal -->
  <div class="main-header">
    <h2>Saisie des donnÃ©es de production d'eau</h2>
  </div>

  <!-- Alerte dynamique -->
  <div *ngIf="showAlert"
       class="dynamic-alert"
       [ngClass]="alertType">
    {{ alertMessage }}
  </div>

  <!-- Conteneur du formulaire -->
  <div class="form-container" [ngClass]="{'visible': isFormVisible}">
    <form [formGroup]="waterForm" (ngSubmit)="onSubmit()">

      <!-- SÃ©lecteur de date -->
      <div class="date-selector">
        <div class="date-header">
          <div class="icon">ğŸ“…</div>
          <h4>PÃ©riode de saisie</h4>
        </div>

        <div class="date-fields-row">
          <div class="form-group compact-field">
            <label class="form-label">AnnÃ©e</label>
            <input type="number"
                   class="form-control"
                   formControlName="year"
                   min="2000"
                   max="2100"
                   [ngClass]="{'error': waterForm.get('year')?.invalid && waterForm.get('year')?.touched}">
            <div *ngIf="waterForm.get('year')?.invalid && waterForm.get('year')?.touched"
                 class="error-message">
              Entre 2000 et 2100
            </div>
          </div>

          <div class="form-group compact-field">
            <label class="form-label">Mois</label>
            <select class="form-select"
                    formControlName="month"
                    [ngClass]="{'error': waterForm.get('month')?.invalid && waterForm.get('month')?.touched}">
              <option *ngFor="let month of months" [value]="month.value">{{month.name}}</option>
            </select>
            <div *ngIf="waterForm.get('month')?.invalid && waterForm.get('month')?.touched"
                 class="error-message">
              SÃ©lection requise
            </div>
          </div>
        </div>
      </div>

      <!-- DonnÃ©es de production -->
      <div class="data-card">
        <div class="card-header">
          <div class="header-content">
            <div class="data-icon">ğŸ’§</div>
            <h3>DonnÃ©es de production d'eau</h3>
          </div>
        </div>

        <div class="card-body">
          <div class="inputs-grid">
            <div class="form-group">
              <label class="form-label">
                <span>ğŸ­</span> F3BIS (mÂ³)
              </label>
              <input type="number"
                     class="form-control"
                     formControlName="f3bis"
                     step="0.01"
                     min="0"
                     placeholder="Saisir la production F3BIS..."
                     [ngClass]="{'error': waterForm.get('f3bis')?.invalid && waterForm.get('f3bis')?.touched}">
              <div *ngIf="waterForm.get('f3bis')?.invalid && waterForm.get('f3bis')?.touched"
                   class="error-message">
                âš ï¸ Veuillez saisir une valeur positive
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">
                <span>ğŸ­</span> F3 (mÂ³)
              </label>
              <input type="number"
                     class="form-control"
                     formControlName="f3"
                     step="0.01"
                     min="0"
                     placeholder="Saisir la production F3..."
                     [ngClass]="{'error': waterForm.get('f3')?.invalid && waterForm.get('f3')?.touched}">
              <div *ngIf="waterForm.get('f3')?.invalid && waterForm.get('f3')?.touched"
                   class="error-message">
                âš ï¸ Veuillez saisir une valeur positive
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">
                <span>ğŸ­</span> SE2 (mÂ³)
              </label>
              <input type="number"
                     class="form-control"
                     formControlName="se2"
                     step="0.01"
                     min="0"
                     placeholder="Saisir la production SE2..."
                     [ngClass]="{'error': waterForm.get('se2')?.invalid && waterForm.get('se2')?.touched}">
              <div *ngIf="waterForm.get('se2')?.invalid && waterForm.get('se2')?.touched"
                   class="error-message">
                âš ï¸ Veuillez saisir une valeur positive
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">
                <span>ğŸ­</span> SE3BIS (mÂ³)
              </label>
              <input type="number"
                     class="form-control"
                     formControlName="se3bis"
                     step="0.01"
                     min="0"
                     placeholder="Saisir la production SE3BIS..."
                     [ngClass]="{'error': waterForm.get('se3bis')?.invalid && waterForm.get('se3bis')?.touched}">
              <div *ngIf="waterForm.get('se3bis')?.invalid && waterForm.get('se3bis')?.touched"
                   class="error-message">
                âš ï¸ Veuillez saisir une valeur positive
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Boutons d'action -->
      <div class="action-buttons">
        <div class="primary-actions">
          <button type="submit"
                  class="btn btn-primary"
                  [disabled]="waterForm.invalid || isLoading">
            <span *ngIf="!isLoading">
              ğŸ’¾ Enregistrer les donnÃ©es
            </span>
            <span *ngIf="isLoading">
              <div class="loading-spinner"></div>
              Enregistrement en cours...
            </span>
          </button>

          <button type="button"
                  class="btn btn-outline-secondary"
                  (click)="resetForm()"
                  [disabled]="isLoading">
            ğŸ—‘ï¸ RÃ©initialiser
          </button>
        </div>

        <div class="secondary-actions">
          <a [routerLink]="getRoutePrefix() + '/water-monthly'" class="btn btn-outline-info">
            ğŸ“Š Tableau Mensuel
          </a>
          <a [routerLink]="getRoutePrefix() + '/water-annual'" class="btn btn-outline-info">
            ğŸ“… Rapport Annuel
          </a>
          <a [routerLink]="getRoutePrefix() + '/water-graphs'" class="btn btn-outline-info">
            ğŸ“ˆ Visualisations
          </a>
        </div>
      </div>
    </form>
  </div>
</div>
