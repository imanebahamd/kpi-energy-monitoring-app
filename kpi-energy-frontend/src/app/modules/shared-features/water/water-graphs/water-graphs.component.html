<div class="water-graphs-container">
  <!-- Alert message -->
  <div *ngIf="showAlert" class="dynamic-alert" [ngClass]="alertType">
    {{ alertMessage }}
  </div>

  <div class="header">
    <h2>Visualisation Graphique de la Production d'Eau</h2>
    <div class="header-actions">
      <a [routerLink]="[getRoutePrefix(), 'water-saisie']" class="btn btn-primary">
        <i class="icon">â•</i> Saisir Nouvelles DonnÃ©es
      </a>
      <a [routerLink]="[getRoutePrefix(), 'water-monthly']" class="btn btn-secondary">
        <i class="icon">ğŸ“…</i> Tableau Mensuel
      </a>
      <a [routerLink]="[getRoutePrefix(), 'water-annual']" class="btn btn-info">
        <i class="icon">ğŸ“Š</i> Tableau Annuel
      </a>
    </div>
  </div>

  <div class="controls">
    <div class="control-group">
      <label>AnnÃ©e: </label>
      <mat-select [(value)]="selectedYear" (selectionChange)="onYearChange()" [disabled]="isLoading">
        <mat-option *ngFor="let year of years" [value]="year">{{ year }}</mat-option>
      </mat-select>
      <span *ngIf="isLoading" class="loading-spinner"></span>
    </div>
  </div>

  <div *ngIf="isLoading" class="loading-message">
    <i class="icon">â³</i> Chargement des donnÃ©es en cours...
  </div>

  <mat-tab-group *ngIf="!isLoading && monthlyData.length > 0">
    <mat-tab label="Tendance Mensuelle">
      <div class="chart-container">
        <p-chart type="line" [data]="monthlyTrendChart" [options]="chartOptions"></p-chart>
      </div>
    </mat-tab>

    <mat-tab label="Comparaison Mensuelle">
      <div class="chart-container">
        <p-chart type="bar" [data]="monthlyComparisonChart" [options]="chartOptions"></p-chart>
      </div>
    </mat-tab>

    <mat-tab label="Composition Annuelle">
      <div class="chart-container">
        <p-chart type="pie" [data]="compositionChart" [options]="chartOptions"></p-chart>
      </div>
    </mat-tab>
  </mat-tab-group>

  <div *ngIf="!isLoading && monthlyData.length === 0" class="no-data">
    <i class="icon">âš ï¸</i>
    <span>Aucune donnÃ©e disponible pour l'annÃ©e sÃ©lectionnÃ©e</span>
  </div>

  <div *ngIf="!isLoading && monthlyData.length > 0" class="data-summary">
    <h3>RÃ©sumÃ© des DonnÃ©es pour {{selectedYear}}</h3>
    <div class="summary-cards">
      <mat-card class="summary-card">
        <mat-card-header>
          <mat-card-title>Production Totale</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <p>{{ getTotalProduction() | number:'1.2-2' }} mÂ³</p>
        </mat-card-content>
      </mat-card>

      <mat-card class="summary-card">
        <mat-card-header>
          <mat-card-title>Moyenne Mensuelle</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <p>{{ getAverageProduction() | number:'1.2-2' }} mÂ³</p>
        </mat-card-content>
      </mat-card>

      <mat-card class="summary-card">
        <mat-card-header>
          <mat-card-title>Max Mensuel</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <p>{{ getMaxProduction() | number:'1.2-2' }} mÂ³</p>
        </mat-card-content>
      </mat-card>

      <mat-card class="summary-card">
        <mat-card-header>
          <mat-card-title>Min Mensuel</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <p>{{ getMinProduction() | number:'1.2-2' }} mÂ³</p>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</div>
